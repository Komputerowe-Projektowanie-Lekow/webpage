<!doctype html>
<html lang="pl">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" data-i18n-meta="meta.micro.description"
    content="Pipeline GUB: zamknięta pętla od generowania molekuł do walidacji komórkowej i systemowej." />
  <title data-i18n-meta="meta.micro.title">Pipeline GUB - Sekcja Inżynierii Mikroorganizmów</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Courier+Prime:wght@400;700&display=swap" rel="stylesheet">
  <link rel="icon" type="image/png" href="./images/logo/sknwpl.png" />
  <link rel="stylesheet" href="./styles.css?v=8" />
</head>

<body>
  <!-- Scroll progress indicator -->
  <div class="scroll-progress" id="scrollProgress" aria-hidden="true"></div>

  <!-- Cmd+K command palette -->
  <div class="cmdk-overlay" id="cmdkOverlay" role="dialog" aria-label="Command palette" aria-modal="true">
    <div class="cmdk-dialog">
      <div class="cmdk-input-wrap">
        <input class="cmdk-input" id="cmdkInput" type="text" placeholder="Navigate, copy email, switch language…" autocomplete="off" spellcheck="false" />
      </div>
      <div class="cmdk-results" id="cmdkResults" role="listbox"></div>
      <div class="cmdk-footer">
        <span>↑↓ navigate</span>
        <span>↵ select</span>
        <span>esc close</span>
      </div>
    </div>
  </div>

  <div id="protein-ascii-layer" class="ascii-layer protein-ascii-layer">
    <pre id="protein-screen-ghost-1" class="ascii-screen ascii-screen-ghost" data-ready="false"
      aria-hidden="true"></pre>
    <pre id="protein-screen-ghost-2" class="ascii-screen ascii-screen-ghost" data-ready="false"
      aria-hidden="true"></pre>
    <pre id="protein-screen" class="ascii-screen ascii-screen-main" data-ready="false" aria-hidden="true"></pre>
    <div class="ascii-caption protein-caption">
      <span data-i18n="micro.ascii.caption">Pipeline GUB - wizualizacja aktywności białka</span>
    </div>
  </div>
  <div id="narrative-ascii-layer" class="ascii-layer narrative-ascii-layer" data-scene="scene-1"
    data-final-hold="false">
    <pre id="narrative-screen-ghost-1" class="ascii-screen ascii-screen-ghost" data-ready="false"
      aria-hidden="true"></pre>
    <pre id="narrative-screen-ghost-2" class="ascii-screen ascii-screen-ghost" data-ready="false"
      aria-hidden="true"></pre>
    <pre id="narrative-screen" class="ascii-screen ascii-screen-main" data-ready="false" aria-hidden="true"></pre>
    <div id="ascii-story-overlay" aria-live="polite">
      <p id="ascii-story-kicker">Narracja ASCII</p>
      <h2 id="ascii-story-title">Komorka pojedyncza</h2>
      <p id="ascii-story-meta">Przejscie od sygnalu komorkowego do modelu wirtualnej komorki.</p>
      <p id="ascii-story-note"></p>
      <div id="ascii-story-actions">
        <a class="ascii-story-action join-action" href="#dolacz">Dołącz</a>
        <a class="ascii-story-action contact-action" href="mailto:sknwpl@proton.me">Kontakt</a>
      <button class="copy-btn" data-copy="sknwpl@proton.me" data-tip="Copy email" style="font-size:0.65rem;min-height:36px;padding:0.3rem 0.5rem;">COPY</button>
      </div>
    </div>
  </div>

  <nav class="sticky-nav" id="stickyNav">
    <div class="nav-content">
      <div class="nav-brand-cell">
        <a href="#kontekst-sekcji" class="nav-brand-link" aria-label="SKNWPL start">
          <span class="nav-brand-badge" aria-hidden="true"></span>
          <span class="nav-brand-text">SKNWPL</span>
        </a>
      </div>
      <div class="nav-links-row">
        <a href="#kontekst-sekcji" class="nav-link" data-i18n="micro.nav.start" data-tip="Home">Start</a>
        <a href="#pipeline" class="nav-link" data-i18n="micro.pipeline.title" data-tip="Pipeline stages">Pipeline</a>
        <a href="#status" class="nav-link" data-i18n="nav.status" data-tip="Current tasks">Status</a>
        <a href="#dolacz" class="nav-link" data-i18n="nav.join" data-tip="Join the team">Dołącz</a>
        <a href="#support" class="nav-link" data-i18n="nav.support" data-tip="Partnership">Wsparcie</a>
        <a href="aqp4.html" class="nav-link project-switch" data-i18n="micro.nav.aqp4">Archiwum: AQP4</a>
      </div>
      <div class="nav-utility-cell">
        <button class="cmdk-trigger" id="cmdkTrigger" aria-label="Open command palette (Ctrl+K)" data-tip="Ctrl+K">
          <span class="cmdk-trigger-label">Ctrl+K</span>
        </button>
        <div class="language-switcher">
          <button class="lang-btn" data-lang="pl" aria-label="Polski" title="Polski">PL</button>
          <button class="lang-btn" data-lang="en" aria-label="English" title="English">EN</button>
        </div>
      </div>
    </div>
  </nav>

  <main class="pages">
    <section class="page hero" id="kontekst-sekcji">
      <div class="page-content">
        <div class="logo-container">
          <img src="./images/logo/sknwpl.png" alt="SKNWPL Logo" class="site-logo" />
        </div>
        <h1 data-i18n="micro.hero.title">Pipeline GUB: projektowanie leków na bakterie Gram-ujemne</h1>
        <p class="hero-lead" data-i18n="micro.hero.lead">
          Budujemy zamkniętą pętlę od projektowania molekuł do weryfikacji komórkowej i systemowej, a wyniki wracają do
          modeli.
        </p>
        <ul class="hero-proof-list">
          <li data-i18n="micro.hero.proof1">Generowanie de novo (REINVENT4)</li>
          <li data-i18n="micro.hero.proof2">Retencja i target engagement (Stage 2-3)</li>
          <li data-i18n="micro.hero.proof3">Wpływ systemowy (Stage 6, COBRApy/iML1515)</li>
        </ul>
        <div class="hero-cta-group">
          <a class="cta cta-primary" href="#dolacz" data-i18n="micro.hero.cta_join">Dołącz</a>
          <a class="cta cta-secondary" href="#pipeline" data-i18n="micro.hero.cta_pipeline">Zobacz pipeline</a>
          <span class="reassurance" data-i18n="micro.hero.reassurance">No sign-up needed to explore.</span>
        </div>
        <p class="hero-tertiary">
          <a href="#support" class="hero-tertiary-link" data-i18n="micro.hero.cta_support">Szukasz współpracy? Zobacz
            wsparcie.</a>
        </p>
      </div>
    </section>

    <section class="page" id="dlaczego">
      <div class="page-content">
        <div class="page-text">
          <h1 data-i18n="micro.why.title">Dlaczego To Ma Znaczenie</h1>
          <p data-i18n="micro.why.intro">
            Wąskie gardła dla leków na bakterie Gram-ujemne pojawiają się między dobrym wynikiem in-silico a realnym
            efektem biologicznym.
          </p>
          <ul class="why-points">
            <li data-i18n="micro.why.point1">Samo powinowactwo nie wystarczy, jeśli cząsteczka nie utrzyma się w
              komórce.</li>
            <li data-i18n="micro.why.point2">Selekcja bez kontekstu metabolicznego pomija systemowe skutki uboczne.</li>
            <li data-i18n="micro.why.point3">Potrzebny jest pipeline, który raportuje artefakty i ograniczenia na każdym
              etapie.</li>
          </ul>
        </div>
        <div class="page-image why-image">
          <img src="./images/helix_macro.png" alt="Helix macro visualization" loading="lazy" decoding="async" />
        </div>
      </div>
    </section>

    <section class="page projects-section" id="pipeline">
      <div class="page-content">
        <div class="page-text">
          <h1 data-i18n="micro.pipeline.title">Pipeline GUB (Gram-Negative & Universal Bacteria)</h1>
          <p data-i18n="micro.pipeline.intro">
            Zintegrowany workflow CADD do projektowania celowanego w E. coli: od generowania molekuł po walidację
            Stage 6A/6B.
          </p>
        </div>

        <div class="projects-accordion">
          <div class="accordion-item special-feature">
            <button class="accordion-header" aria-expanded="false">
              <span class="accordion-title" data-i18n="micro.ouroboros.title">Pętla Ouroboros</span>
              <span class="accordion-icon">˅</span>
            </button>
            <div class="accordion-content">
              <div class="project-details">
                <div class="project-intro">
                  <p class="highlight-text" data-i18n="micro.ouroboros.subtitle">Iteracyjne uczenie pipeline'u na
                    wynikach walidacji.</p>
                  <p data-i18n="micro.ouroboros.desc">
                    Aktualnie działa inżynieryjna pętla eksperymentalna i walidacyjna. Nie traktujemy jej jako w pełni
                    autonomicznego systemu produkcyjnego.
                  </p>
                </div>
                <div class="credibility-split">
                  <div class="credibility-card">
                    <h3 data-i18n="micro.ouroboros.live.title">Działa dziś (na dzień 2026-02-10)</h3>
                    <ul>
                      <li data-i18n="micro.ouroboros.live.item1">Kontrakty API (Pydantic) i stage_runner.py na etapach
                        1-6.</li>
                      <li data-i18n="micro.ouroboros.live.item2">EXP3 pilot15 (top_n=10): Stage1 -> Stage6 + finalize
                        zakończone.</li>
                      <li data-i18n="micro.ouroboros.live.item3">EXP2 surrogate loop (n=15): true pass-rate 0.575 ->
                        0.625.</li>
                    </ul>
                  </div>
                  <div class="credibility-card target-card">
                    <h3 data-i18n="micro.ouroboros.target.title">Architektura docelowa</h3>
                    <ul>
                      <li data-i18n="micro.ouroboros.target.item1">Stabilny full-scale chain dla profili full10/full100.
                      </li>
                      <li data-i18n="micro.ouroboros.target.item2">Ujednolicenie kontraktu Stage6B (target_gene: CSV vs
                        CLI).</li>
                      <li data-i18n="micro.ouroboros.target.item3">Rerun rankingu na >=100 rekordach z realnym KD_pred
                        ze Stage 4.</li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="accordion-item">
            <button class="accordion-header" aria-expanded="false">
              <span class="accordion-title" data-i18n="micro.step1.title">1. Generowanie (REINVENT4)</span>
              <span class="accordion-icon">˅</span>
            </button>
            <div class="accordion-content">
              <div class="project-details">
                <p data-i18n="micro.step1.desc">
                  Generowanie i postprocess bibliotek SMILES z walidacją konfiguracji i deterministycznym zapisem
                  artefaktów Stage 1.
                </p>
                <div class="step-output-row">
                  <span class="step-output-label" data-i18n="micro.step.output.label">Output (ostatni znany stan)</span>
                  <span class="step-output-value" data-i18n="micro.step1.output">12 797 rekordów wejścia; 12 581 valid
                    po walidacji Stage2a.</span>
                </div>
                <div class="step-status-row">
                  <span class="status-badge live" data-i18n="micro.status.live">live</span>
                </div>
              </div>
            </div>
          </div>

          <div class="accordion-item">
            <button class="accordion-header" aria-expanded="false">
              <span class="accordion-title" data-i18n="micro.step2.title">2. Retencja i Engagement</span>
              <span class="accordion-icon">˅</span>
            </button>
            <div class="accordion-content">
              <div class="project-details">
                <p data-i18n="micro.step2.desc">
                  Łączenie Stage 2a/2b z CellTE, aby oszacować retencję, entry score i wstępne target engagement przed
                  strukturą Boltz2.
                </p>
                <div class="step-output-row">
                  <span class="step-output-label" data-i18n="micro.step.output.label">Output (ostatni znany stan)</span>
                  <span class="step-output-value" data-i18n="micro.step2.output">Inference retencji zweryfikowane na
                    ~12.8k cząsteczek.</span>
                </div>
                <div class="step-status-row">
                  <span class="status-badge live" data-i18n="micro.status.live">live</span>
                </div>
              </div>
            </div>
          </div>

          <div class="accordion-item">
            <button class="accordion-header" aria-expanded="false">
              <span class="accordion-title" data-i18n="micro.step3.title">3. Predykcja Struktur (Boltz2)</span>
              <span class="accordion-icon">˅</span>
            </button>
            <div class="accordion-content">
              <div class="project-details">
                <p data-i18n="micro.step3.desc">
                  Etap strukturalny generuje i porządkuje kandydatów do Boltz2 oraz ranking powinowactwa na podstawie
                  przetworzonego `summary.csv`.
                </p>
                <div class="step-output-row">
                  <span class="step-output-label" data-i18n="micro.step.output.label">Output (ostatni znany stan)</span>
                  <span class="step-output-value" data-i18n="micro.step3.output">`stage3_for_boltz2.csv`: top 200
                    kandydatów.</span>
                </div>
                <div class="step-status-row">
                  <span class="status-badge stabilizing" data-i18n="micro.status.stabilizing">stabilizing</span>
                </div>
              </div>
            </div>
          </div>

          <div class="accordion-item">
            <button class="accordion-header" aria-expanded="false">
              <span class="accordion-title" data-i18n="micro.step4.title">4. KD Predykcja i MD</span>
              <span class="accordion-icon">˅</span>
            </button>
            <div class="accordion-content">
              <div class="project-details">
                <p data-i18n="micro.step4.desc">
                  Stage 4 konwertuje `affinity_log_ic50` do `KD_pred` i sortuje wyniki deterministycznie przed
                  przekazaniem do etapów dynamicznych.
                </p>
                <div class="step-output-row">
                  <span class="step-output-label" data-i18n="micro.step.output.label">Output (ostatni znany stan)</span>
                  <span class="step-output-value" data-i18n="micro.step4.output">`stage4_output.csv` z `KD_pred`;
                    ranking deterministyczny po hardeningu 2026-02-09.</span>
                </div>
                <div class="step-status-row">
                  <span class="status-badge active-hardening" data-i18n="micro.status.active_hardening">active
                    hardening</span>
                </div>
              </div>
            </div>
          </div>

          <div class="accordion-item">
            <button class="accordion-header" aria-expanded="false">
              <span class="accordion-title" data-i18n="micro.step5.title">5. Wpływ Systemowy (Stage 6)</span>
              <span class="accordion-icon">˅</span>
            </button>
            <div class="accordion-content">
              <div class="project-details">
                <p data-i18n="micro.step5.desc">
                  Stage 5/6 weryfikuje stabilność i wpływ metaboliczny (6A/6B) z jawnymi quality gates i metrykami
                  pokrycia.
                </p>
                <div class="step-output-row">
                  <span class="step-output-label" data-i18n="micro.step.output.label">Output (ostatni znany stan)</span>
                  <span class="step-output-value" data-i18n="micro.step5.output">`stage3_for_gromacs.csv` top 50;
                    raporty
                    Stage6 dla pilot 20 i full 100.</span>
                </div>
                <div class="step-status-row">
                  <span class="status-badge active-hardening" data-i18n="micro.status.active_hardening">active
                    hardening</span>
                </div>
              </div>
            </div>
          </div>

          <div class="accordion-item">
            <button class="accordion-header" aria-expanded="false">
              <span class="accordion-title" data-i18n="micro.limits.title">Znane ograniczenia (2026-02-10)</span>
              <span class="accordion-icon">˅</span>
            </button>
            <div class="accordion-content">
              <div class="project-details">
                <p data-i18n="micro.limits.intro">
                  Poniższe punkty to aktualny status inżynieryjny, a nie końcowe twierdzenia biologiczne.
                </p>
                <ul class="limitations-list">
                  <li data-i18n="micro.limits.item1">EXP1 affinity-only: blindspot_rate=1.0 dla targetu b0048
                    (N=100) w tym konkretnym setupie.</li>
                  <li data-i18n="micro.limits.item2">EXP3 full10: był mismatch kontraktu Stage6B; fix wdrożony, rerun
                    oczekuje potwierdzenia.</li>
                </ul>
                <p data-i18n="micro.limits.note">
                  Priorytetem jest domknięcie rerunów i kontraktów, zanim uznamy pętlę za stabilną produkcyjnie.
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="page" id="status">
      <div class="page-content">
        <div class="page-text">
          <h1 data-i18n="micro.status_section.title">Repozytoria i Aktualne Zadania</h1>
          <p data-i18n="micro.status_section.intro">
            Ten widok ma przyspieszyć onboarding: co już działa, co jest w toku i gdzie można wejść z pracą.
          </p>

          <h2 data-i18n="micro.status_section.repos_title">Główne moduły pipeline</h2>
          <div class="cards-grid">
            <article class="info-card">
              <h3 data-i18n="micro.repo1.title">REINVENT4 + analiza + retencja</h3>
              <p data-i18n="micro.repo1.desc">Generowanie, filtrowanie i scoring wejścia dla Stage 3 z obsługą dużych
                bibliotek.</p>
              <p class="card-meta" data-i18n="micro.repo1.meta">Walidacje środowiska + hardening log-driven
                (2026-02-09).</p>
            </article>
            <article class="info-card">
              <h3 data-i18n="micro.repo2.title">CellTE + Boltz2 + GROMACS</h3>
              <p data-i18n="micro.repo2.desc">Etap kinetyczny i strukturalny z kontraktami CSV oraz etapami pre/post
                Boltz2.</p>
              <p class="card-meta" data-i18n="micro.repo2.meta">Top 200 do Boltz2 i top 50 do GROMACS w aktualnym
                przepływie.</p>
            </article>
            <article class="info-card">
              <h3 data-i18n="micro.repo3.title">Biologia systemowa Stage 6A/6B</h3>
              <p data-i18n="micro.repo3.desc">FBA/FVA, quality gates, preflight targetów i raporty blindspot.</p>
              <p class="card-meta" data-i18n="micro.repo3.meta">EXP1: pilot 20 + full 100; metryki i ograniczenia
                jawnie raportowane.</p>
            </article>
          </div>

          <h2 data-i18n="micro.status_section.tasks_title">Otwarte zadania na teraz</h2>
          <div class="tasks-list">
            <article class="task-item">
              <h3 data-i18n="micro.task1.title">EXP3 full10 rerun po synchronizacji</h3>
              <p data-i18n="micro.task1.desc">Potwierdzić przejście 90_stage6b i 99_finalize oraz komplet
                `run_manifest.json`/`report.md`.</p>
              <p class="task-meta" data-i18n="micro.task1.meta">Status: aktywne (notes/03_experiments).</p>
            </article>
            <article class="task-item">
              <h3 data-i18n="micro.task2.title">Ujednolicić kontrakt Stage6BInput</h3>
              <p data-i18n="micro.task2.desc">Zdecydować docelowo czy `target_gene` ma być w CSV, w CLI, czy w obu
                warstwach z twardą walidacją.</p>
              <p class="task-meta" data-i18n="micro.task2.meta">Status: otwarte pytanie kontraktowe.</p>
            </article>
            <article class="task-item">
              <h3 data-i18n="micro.task3.title">Powtórzyć EXP1 na Stage4 KD_pred >= 100</h3>
              <p data-i18n="micro.task3.desc">Porównać blindspot_rate między selekcją `qed` i rzeczywistym rankingiem
                `KD_pred`.</p>
              <p class="task-meta" data-i18n="micro.task3.meta">Status: oczekuje większego zbioru Stage 4.</p>
            </article>
            <article class="task-item">
              <h3 data-i18n="micro.task4.title">Ustalić produkcyjne progi quality gates</h3>
              <p data-i18n="micro.task4.desc">Domknąć progi Stage 6A/6B (`strict-quality-gates`) i opisać je jako
                stały standard runów.</p>
              <p class="task-meta" data-i18n="micro.task4.meta">Status: in progress.</p>
            </article>
          </div>
        </div>
      </div>
    </section>

    <section class="page" id="dolacz">
      <div class="page-content">
        <div class="page-text">
          <h1 data-i18n="micro.join.title">Dołącz do zespołu GUB</h1>
          <p data-i18n="micro.join.text">
            Szukamy osób, które chcą budować rzetelny pipeline badawczy i regularnie domykać zadania inżynieryjne.
          </p>

          <h2 data-i18n="micro.join.roles.title">Obszary pracy</h2>
          <ul>
            <li><strong data-i18n="micro.join.role1.title">Infrastruktura i automatyzacja</strong> <span
                data-i18n="micro.join.role1.desc">- Slurm, handoff, walidacje etapów i niezawodność runów.</span></li>
            <li><strong data-i18n="micro.join.role2.title">Modelowanie molekularne</strong> <span
                data-i18n="micro.join.role2.desc">- REINVENT4, Boltz2, GROMACS, interpretacja wyników
                strukturalnych.</span></li>
            <li><strong data-i18n="micro.join.role3.title">Biologia systemowa</strong> <span
                data-i18n="micro.join.role3.desc">- Stage 6A/6B, quality gates, analiza ryzyka metabolicznego.</span>
            </li>
          </ul>

          <h2 data-i18n="micro.join.expectations.title">Czego oczekujemy</h2>
          <ul>
            <li data-i18n="micro.join.expect1">Autonomia i dowożenie zadań od diagnozy do artefaktu.</li>
            <li data-i18n="micro.join.expect2">Komfort z niepewnością i systematyczne debugowanie.</li>
            <li data-i18n="micro.join.expect3">Jasna komunikacja postępu w rytmie tygodniowym.</li>
          </ul>

          <h2 data-i18n="micro.join.apply.title">Jak aplikować</h2>
          <ol>
            <li data-i18n="micro.join.apply.step1">Napisz, w którym obszarze chcesz wejść i jaki problem chcesz
              przejąć.</li>
            <li data-i18n="micro.join.apply.step2">Po krótkiej rozmowie dostajesz zadanie startowe i plan wdrożenia.
            </li>
          </ol>
          <p data-i18n="micro.join.apply.note">Liczy się rzetelność wykonania i iteracyjna poprawa jakości, nie
            formalny papier.</p>
        </div>
      </div>
    </section>

    <section class="page" id="support">
      <div class="page-content">
        <div class="page-text">
          <h1 data-i18n="micro.support.title">Wsparcie i partnerstwo</h1>
          <p data-i18n="micro.support.text">
            Jeśli chcesz przyspieszyć ten pipeline, poniżej są konkretne potrzeby operacyjne.
          </p>
          <ul>
            <li data-i18n="micro.support.ask1">Compute credits i infrastruktura HPC pod powtarzalne runy Stage 1-6.</li>
            <li data-i18n="micro.support.ask2">Dostęp do walidacji wet-lab dla wybranych kandydatów po filtrach Stage 6.
            </li>
            <li data-i18n="micro.support.ask3">Mentoring ekspercki: MD, FBA/COBRA i projektowanie eksperymentów.</li>
          </ul>
          <a class="cta support-cta" href="mailto:sknwpl@proton.me" data-i18n="micro.support.cta">Skontaktuj się w
            sprawie współpracy</a>
          <button class="copy-btn" data-copy="sknwpl@proton.me" data-tip="Copy email">COPY EMAIL</button>
          <p class="reassurance" data-i18n="micro.support.reassurance">Your data stays private. No spam.</p>
        </div>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="footer-panels">
      <section class="footer-panel footer-panel--mission">
        <h3 data-i18n="footer.dream.title">Projekt powstał z marzeń o obliczaniu tego, co wydaje się niemożliwe.</h3>
        <p data-i18n="footer.dream.text">
          Jedyne pytanie, na które szukamy odpowiedzi, brzmi: czy można zaprojektować lek bez laboratorium? To zadanie
          piekielnie trudne, ale z pomocą metod komputerowych możemy przynajmniej zwiększyć szansę, że rozwiązania
          przetrwają etap kliniczny.
        </p>
      </section>
      <section class="footer-panel footer-panel--contact">
        <h3 data-i18n="footer.contact.title">Kontakt i adresy</h3>
        <p class="footer-contact-lines">
          <a href="https://github.com/Komputerowe-Projektowanie-Lekow" data-i18n="footer.contact.github">Repozytorium
            na GitHubie</a><br>
          <a href="mailto:sknwpl@proton.me" data-i18n="footer.contact.email">Kontakt</a><br>
          <span data-i18n="footer.contact.email.text">Email: sknwpl(at)proton(dot)me</span>
        </p>
      </section>
      <section class="footer-panel footer-panel--partners">
        <h3 data-i18n="footer.partners.title">Partnerzy / wsparcie</h3>
        <p data-i18n-html="footer.partners.text">
          Otwarte zaproszenie do współpracy (sprzęt, granty, konsultacje).<br>
          Jeżeli chcesz się odezwać z pytaniem, jakąś współpracą naukową itp. - skontaktuj się z nami.
        </p>
      </section>
      <section class="footer-panel footer-panel--join">
        <p data-i18n="footer.bottom">Dołącz do nas i podziel się swoimi umiejętnościami.</p>
      </section>
    </div>
  </footer>

  <script type="module" src="./i18n.js"></script>
  <script type="module" src="./main.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const accordionHeaders = document.querySelectorAll(".accordion-header");

      accordionHeaders.forEach(function (header) {
        header.setAttribute("aria-expanded", "false");

        header.addEventListener("click", function (e) {
          e.preventDefault();
          const isExpanded = header.getAttribute("aria-expanded") === "true";

          accordionHeaders.forEach(function (otherHeader) {
            if (otherHeader !== header) {
              otherHeader.setAttribute("aria-expanded", "false");
            }
          });

          header.setAttribute("aria-expanded", !isExpanded ? "true" : "false");
        });
      });

      const stickyNav = document.getElementById("stickyNav");
      const heroSection = document.querySelector(".hero");
      const navLinks = Array.from(document.querySelectorAll(".nav-link[href^=\"#\"]"));
      const trackedSections = navLinks
        .map((link) => {
          const targetId = link.getAttribute("href").slice(1);
          return {
            id: targetId,
            link: link,
            section: document.getElementById(targetId)
          };
        })
        .filter((entry) => entry.section);

      function setActiveNavLink(activeId) {
        navLinks.forEach((link) => {
          const isActive = link.getAttribute("href") === "#" + activeId;
          link.classList.toggle("is-active", isActive);
          if (isActive) {
            link.setAttribute("aria-current", "page");
          } else {
            link.removeAttribute("aria-current");
          }
        });
      }

      function updateActiveNavLink() {
        if (!trackedSections.length) return;

        const navHeight = stickyNav ? stickyNav.offsetHeight : 0;
        const threshold = navHeight + 36;
        let activeSectionId = trackedSections[0].id;

        trackedSections.forEach((entry) => {
          const rectTop = entry.section.getBoundingClientRect().top;
          if (rectTop <= threshold) {
            activeSectionId = entry.id;
          }
        });

        const nearPageBottom = window.innerHeight + window.scrollY >= document.documentElement.scrollHeight - 2;
        if (nearPageBottom) {
          activeSectionId = trackedSections[trackedSections.length - 1].id;
        }

        setActiveNavLink(activeSectionId);
      }

      function checkNavVisibility() {
        if (!heroSection || !stickyNav) return;

        const heroBottom = heroSection.offsetTop + heroSection.offsetHeight;
        const scrollPosition = window.scrollY;

        if (scrollPosition > heroBottom - 100) {
          stickyNav.classList.add("visible");
        } else {
          stickyNav.classList.remove("visible");
        }
      }

      function handleScroll() {
        checkNavVisibility();
        updateActiveNavLink();
      }

      window.addEventListener("scroll", handleScroll, { passive: true });
      window.addEventListener("resize", updateActiveNavLink, { passive: true });
      updateActiveNavLink();
      checkNavVisibility();

      /* ========== SCROLL PROGRESS BAR ========== */
      const progressBar = document.getElementById("scrollProgress");
      function updateScrollProgress() {
        const scrollTop = window.scrollY;
        const docHeight = document.documentElement.scrollHeight - window.innerHeight;
        if (docHeight > 0 && progressBar) {
          progressBar.style.width = ((scrollTop / docHeight) * 100).toFixed(2) + "%";
        }
      }
      window.addEventListener("scroll", updateScrollProgress, { passive: true });
      updateScrollProgress();

      /* ========== PERSISTENT SCROLL STATE ========== */
      const SCROLL_KEY = "sknwpl_scroll_y";
      const savedY = sessionStorage.getItem(SCROLL_KEY);
      if (savedY !== null) {
        requestAnimationFrame(function () {
          window.scrollTo({ top: parseInt(savedY, 10), behavior: "instant" });
        });
      }
      let scrollSaveRaf = null;
      window.addEventListener("scroll", function () {
        if (scrollSaveRaf) return;
        scrollSaveRaf = requestAnimationFrame(function () {
          sessionStorage.setItem(SCROLL_KEY, String(Math.round(window.scrollY)));
          scrollSaveRaf = null;
        });
      }, { passive: true });

      /* ========== COPY-TO-CLIPBOARD BUTTONS ========== */
      document.querySelectorAll(".copy-btn[data-copy]").forEach(function (btn) {
        btn.addEventListener("click", function (e) {
          e.preventDefault();
          var text = btn.getAttribute("data-copy");
          if (!text) return;
          navigator.clipboard.writeText(text).then(function () {
            btn.classList.add("copied");
            var orig = btn.textContent;
            btn.textContent = "COPIED";
            setTimeout(function () {
              btn.textContent = orig;
              btn.classList.remove("copied");
            }, 1600);
          }).catch(function () {
            /* fallback: select in a textarea */
            var ta = document.createElement("textarea");
            ta.value = text;
            ta.style.cssText = "position:fixed;left:-9999px;opacity:0";
            document.body.appendChild(ta);
            ta.select();
            document.execCommand("copy");
            document.body.removeChild(ta);
            btn.classList.add("copied");
            var origFb = btn.textContent;
            btn.textContent = "COPIED";
            setTimeout(function () { btn.textContent = origFb; btn.classList.remove("copied"); }, 1600);
          });
        });
      });

      /* ========== CMD+K COMMAND PALETTE ========== */
      var cmdkOverlay = document.getElementById("cmdkOverlay");
      var cmdkInput = document.getElementById("cmdkInput");
      var cmdkResults = document.getElementById("cmdkResults");
      var cmdkActiveIdx = -1;

      var cmdkCommands = [
        { icon: "\u2302", label: "Start", hint: "home", action: function () { location.hash = "#kontekst-sekcji"; } },
        { icon: "\u25b6", label: "Pipeline", hint: "stages", action: function () { location.hash = "#pipeline"; } },
        { icon: "\u2261", label: "Status", hint: "tasks", action: function () { location.hash = "#status"; } },
        { icon: "+", label: "Do\u0142\u0105cz", hint: "join", action: function () { location.hash = "#dolacz"; } },
        { icon: "\u2764", label: "Wsparcie", hint: "support", action: function () { location.hash = "#support"; } },
        { icon: "\u2709", label: "Copy email", hint: "clipboard", action: function () {
          navigator.clipboard.writeText("sknwpl@proton.me").then(function(){}).catch(function(){});
        }},
        { icon: "EN", label: "Switch to English", hint: "language", action: function () {
          if (window.i18n) window.i18n.setLanguage("en");
        }},
        { icon: "PL", label: "Prze\u0142\u0105cz na polski", hint: "j\u0119zyk", action: function () {
          if (window.i18n) window.i18n.setLanguage("pl");
        }},
        { icon: "\u21e7", label: "Scroll to top", hint: "top", action: function () { window.scrollTo({ top: 0, behavior: "smooth" }); } }
      ];

      function openCmdk() {
        if (!cmdkOverlay) return;
        cmdkOverlay.classList.add("open");
        cmdkInput.value = "";
        cmdkActiveIdx = -1;
        renderCmdk("");
        requestAnimationFrame(function () { cmdkInput.focus(); });
      }

      function closeCmdk() {
        if (!cmdkOverlay) return;
        cmdkOverlay.classList.remove("open");
        cmdkInput.blur();
      }

      function renderCmdk(query) {
        var q = query.toLowerCase().trim();
        var matches = cmdkCommands.filter(function (c) {
          if (!q) return true;
          return c.label.toLowerCase().indexOf(q) !== -1 || c.hint.toLowerCase().indexOf(q) !== -1;
        });
        cmdkResults.innerHTML = "";
        if (matches.length === 0) {
          cmdkResults.innerHTML = '<div class="cmdk-empty">No results</div>';
          return;
        }
        matches.forEach(function (cmd, idx) {
          var el = document.createElement("button");
          el.className = "cmdk-item" + (idx === cmdkActiveIdx ? " active" : "");
          el.setAttribute("role", "option");
          el.innerHTML = '<span class="cmdk-item-icon">' + cmd.icon + '</span>' +
            '<span class="cmdk-item-label">' + cmd.label + '</span>' +
            '<span class="cmdk-item-hint">' + cmd.hint + '</span>';
          el.addEventListener("click", function () { cmd.action(); closeCmdk(); });
          el.addEventListener("mouseenter", function () {
            cmdkActiveIdx = idx;
            highlightCmdk();
          });
          cmdkResults.appendChild(el);
        });
      }

      function highlightCmdk() {
        var items = cmdkResults.querySelectorAll(".cmdk-item");
        items.forEach(function (el, i) {
          el.classList.toggle("active", i === cmdkActiveIdx);
        });
      }

      function getVisibleCmdkItems() {
        return cmdkResults.querySelectorAll(".cmdk-item");
      }

      document.addEventListener("keydown", function (e) {
        /* Ctrl+K or Cmd+K to open */
        if ((e.metaKey || e.ctrlKey) && e.key === "k") {
          e.preventDefault();
          if (cmdkOverlay && cmdkOverlay.classList.contains("open")) {
            closeCmdk();
          } else {
            openCmdk();
          }
          return;
        }
        if (!cmdkOverlay || !cmdkOverlay.classList.contains("open")) return;
        if (e.key === "Escape") {
          e.preventDefault();
          closeCmdk();
          return;
        }
        var items = getVisibleCmdkItems();
        if (e.key === "ArrowDown") {
          e.preventDefault();
          cmdkActiveIdx = Math.min(cmdkActiveIdx + 1, items.length - 1);
          highlightCmdk();
          if (items[cmdkActiveIdx]) items[cmdkActiveIdx].scrollIntoView({ block: "nearest" });
        } else if (e.key === "ArrowUp") {
          e.preventDefault();
          cmdkActiveIdx = Math.max(cmdkActiveIdx - 1, 0);
          highlightCmdk();
          if (items[cmdkActiveIdx]) items[cmdkActiveIdx].scrollIntoView({ block: "nearest" });
        } else if (e.key === "Enter") {
          e.preventDefault();
          if (items[cmdkActiveIdx]) items[cmdkActiveIdx].click();
        }
      });

      if (cmdkInput) {
        cmdkInput.addEventListener("input", function () {
          cmdkActiveIdx = 0;
          renderCmdk(cmdkInput.value);
        });
      }

      if (cmdkOverlay) {
        cmdkOverlay.addEventListener("click", function (e) {
          if (e.target === cmdkOverlay) closeCmdk();
        });
      }

      /* ========== CMDK TRIGGER BUTTON IN NAV ========== */
      var cmdkTriggerBtn = document.getElementById("cmdkTrigger");
      if (cmdkTriggerBtn) {
        cmdkTriggerBtn.addEventListener("click", function (e) {
          e.preventDefault();
          openCmdk();
        });
      }
    });
  </script>
</body>

</html>